{"version":3,"file":"chunk-domLib.js","sources":["../../../web-components/src/lib/webservices/src/legacy/lib/lib.js","../../../web-components/src/lib/webservices/src/legacy/lib/domLib.js"],"sourcesContent":["/** ****************************************************************************\n   Generic Helpers\n***************************************************************************** */\n\nexport const pluck = (k, objs) =>\n  objs.reduce((acc, obj) => [...acc, obj[k]], []);\n\nexport const uniq = (xs) => Array.from(new Set(xs));\n\nexport const isUpper = (c) => /[A-Z]/.test(c);\n\nexport const capitalize = (s) => `${s.charAt(0).toUpperCase()}${s.substr(1)}`;\n\nexport const camelToKebab = (s) =>\n  Array.from(s).reduce(\n    (acc, c, i) => acc + (isUpper(c) ? `${i ? \"-\" : \"\"}${c.toLowerCase()}` : c),\n    \"\"\n  );\n\nexport function kebabToCamel(s) {\n  const splits = s.split(\"-\");\n  return splits[0] + splits.slice(1).map(capitalize).join(\"\");\n}\n\nexport const pluralize = (s, num = 2, suffix = \"s\") =>\n  num > 1 ? s + suffix : s;\n\nexport function formatChoices(choices) {\n  /* Format an array of string-type choices as a choice list string. */\n  const lastIdx = choices.length - 1;\n  switch (choices.length) {\n    case 0:\n      return \"\";\n    case 1:\n      return `${choices[0]}`;\n    case 2:\n      return `${choices[0]} or ${choices[1]}`;\n    default:\n      return `${choices.slice(0, lastIdx).join(\", \")}, or ${choices[lastIdx]}`;\n  }\n}\n\nexport function populateTemplate(template, obj) {\n  /* Return the result of interpolating the template string with\n     the referenced obj properties.\n     Example template: \"/:account/collections/:collection\"\n\n     References with the suffix \"|json\" will be encoded as HTML-escaped JSON.\n   */\n  // Maybe need to support non-whole-path-segment replacements, but\n  // let's just do that for now.\n  const regex = /:[a-zA-Z_|]+/g;\n  return template.replaceAll(regex, (match) => {\n    const splits = match.slice(1).split(\"|\");\n    switch (splits.length) {\n      case 1:\n        return obj[splits[0]];\n      case 2:\n        if (splits[1] !== \"json\") {\n          throw new Error(`Unsupported template filter: ${splits[1]}`);\n        }\n        return JSON.stringify(obj[splits[0]]).replace(/\"/g, \"&quot;\");\n      default:\n        throw new Error(`Unparsable template reference: ${match}`);\n    }\n  });\n}\n\n/** ****************************************************************************\n   Javascript Helpers\n***************************************************************************** */\n\nexport const getBoundMethod = (ins, methodName) => ins[methodName].bind(ins);\n\nexport function ThrottledLIFO(minIntervalMs = 300) {\n  /*\n     Return a function that accepts a single (async) function argument\n     whose invocations will be throttled based on minIntervalMs with only\n     the last invocation being executed.\n   */\n  let handle;\n  let _reject = () => undefined;\n  // Return a promise that will be resolved in the case of execution or\n  // rejected in the case of a throttle.\n  return (func) => {\n    _reject(\"throttled\");\n    clearTimeout(handle);\n    return new Promise((resolve, reject) => {\n      handle = setTimeout(async () => resolve(await func()), minIntervalMs);\n      _reject = reject;\n    });\n  };\n}\n","import { camelToKebab } from \"./lib.js\";\n\nexport function createElement(tagName, attrs = {}) {\n  const finalAttrs = Object.assign({}, attrs);\n  // Pop any defined children value.\n  const children = attrs.children ?? [];\n  delete finalAttrs.children\n  // Pop any defined classList value and filter non-strings.\n  const classList = (attrs.classList ?? []).filter(x => typeof(x) === \"string\");\n  delete finalAttrs.classList\n  // Pop any defined dataset.\n  const dataset = attrs.dataset;\n  delete finalAttrs.dataset;\n  // If children and textContent are specified, move textContent into children.\n  if (children.length && attrs.textContent) {\n    children.unshift(attrs.textContent);\n    delete finalAttrs.textContent;\n  }\n  // If classList and className are defined, move className into classList.\n  if (classList.length && attrs.className) {\n    classList.unshift(attrs.className);\n    delete finalAttrs.className;\n  }\n  // Create the element with the specified finalAttrs.\n  const el = Object.assign(document.createElement(tagName), finalAttrs);\n  // Maybe set the children.\n  if (children.length) {\n    el.replaceChildren(...children);\n  }\n  // Maybe set the classes.\n  if (classList.length) {\n    el.classList.add(...classList);\n  }\n  // Maybe update the dataset.\n  if (typeof(dataset) === \"object\") {\n    Object.assign(el.dataset, dataset);\n  }\n  return el;\n}\n\nexport function customElementsMaybeDefine(tagName, cls, ...args) {\n  /* customElements.define() wrapper that first checks whether tagName\n     has already been defined.\n   */\n  if (!customElements.get(tagName)) {\n    customElements.define(tagName, cls, ...args);\n  }\n}\n\nexport const slugify = (s) => s.toLowerCase().replace(/[^a-zA-Z0-9\\-_]/g, \"-\");\n\nexport function parseElementProps(el, objKeys, errorOnMissing = true) {\n  /*\n     Return an object with the specified objKeys that results from parsing\n     an Element's attributes. In the event of a missing objOkey, you can\n     specify an Array-type objKeys value with the a default value as the\n     second element, i.e. [ <objKey>, <defaultValue> ]\n\n     Example:\n       el: <div first-val=\"1\" second-val=\"[2,3,4]\" third-val=\"&quot;ok&quot;\"`>\n       objKeys: [ \"firstVal\", \"secondVal\", \"thirdVal\" ]\n       result: { firstVal: 1, secondVal: [2, 3, 4], thirdVal: \"ok\" }\n   */\n  const obj = {};\n  const missingAttrs = [];\n  for (let objKey of objKeys) {\n    let defaultValue;\n    if (Array.isArray(objKey)) {\n      [objKey, defaultValue] = objKey;\n    }\n    const attrName = camelToKebab(objKey);\n    if (!el.hasAttribute(attrName)) {\n      if (defaultValue !== undefined) {\n        obj[objKey] = defaultValue;\n      } else {\n        missingAttrs.push(attrName);\n        obj[objKey] = undefined;\n      }\n    } else {\n      const attrValue = el.getAttribute(attrName);\n      if (attrValue === \"\") {\n        // Interpret a present, empty attribute value as true.\n        obj[objKey] = true;\n      } else {\n        obj[objKey] = JSON.parse(attrValue);\n      }\n    }\n  }\n  if (missingAttrs.length > 0 && errorOnMissing) {\n    console.warn(el); // eslint-disable-line no-console\n    throw new Error(`Element is missing required attributes: ${missingAttrs}`);\n  }\n  return obj;\n}\n"],"names":["camelToKebab","s","Array","from","reduce","acc","c","i","test","isUpper","toLowerCase","formatChoices","choices","lastIdx","length","slice","join","populateTemplate","template","obj","replaceAll","match","splits","split","Error","JSON","stringify","replace","ThrottledLIFO","minIntervalMs","handle","_reject","func","clearTimeout","Promise","resolve","reject","setTimeout","async","createElement","tagName","attrs","finalAttrs","Object","assign","children","classList","filter","x","dataset","textContent","unshift","className","el","document","replaceChildren","add","customElementsMaybeDefine","cls","args","customElements","get","define","slugify","parseElementProps","objKeys","errorOnMissing","missingAttrs","objKey","defaultValue","isArray","attrName","hasAttribute","attrValue","getAttribute","parse","undefined","push","console","warn"],"mappings":"AASO,MAIMA,EAAgBC,GAC3BC,MAAMC,KAAKF,GAAGG,QACZ,CAACC,EAAKC,EAAGC,IAAMF,GANI,CAACC,GAAM,QAAQE,KAAKF,GAMjBG,CAAQH,GAAK,GAAGC,EAAI,IAAM,KAAKD,EAAEI,gBAAkBJ,IACzE,IAWG,SAASK,EAAcC,GAE5B,MAAMC,EAAUD,EAAQE,OAAS,EACjC,OAAQF,EAAQE,QACd,KAAK,EACH,MAAO,GACT,KAAK,EACH,MAAO,GAAGF,EAAQ,KACpB,KAAK,EACH,MAAO,GAAGA,EAAQ,SAASA,EAAQ,KACrC,QACE,MAAO,GAAGA,EAAQG,MAAM,EAAGF,GAASG,KAAK,aAAaJ,EAAQC,KAEpE,CAEO,SAASI,EAAiBC,EAAUC,GAUzC,OAAOD,EAASE,WADF,iBACqBC,IACjC,MAAMC,EAASD,EAAMN,MAAM,GAAGQ,MAAM,KACpC,OAAQD,EAAOR,QACb,KAAK,EACH,OAAOK,EAAIG,EAAO,IACpB,KAAK,EACH,GAAkB,SAAdA,EAAO,GACT,MAAM,IAAIE,MAAM,gCAAgCF,EAAO,MAEzD,OAAOG,KAAKC,UAAUP,EAAIG,EAAO,KAAKK,QAAQ,KAAM,UACtD,QACE,MAAM,IAAIH,MAAM,kCAAkCH,KACrD,GAEL,CAQO,SAASO,EAAcC,EAAgB,KAM5C,IAAIC,EACAC,EAAU,KAAe,EAG7B,OAAQC,IACND,EAAQ,aACRE,aAAaH,GACN,IAAII,SAAQ,CAACC,EAASC,KAC3BN,EAASO,YAAWC,SAAYH,QAAcH,MAASH,GACvDE,EAAUK,CAAM,IAGtB,CC1FO,SAASG,EAAcC,EAASC,EAAQ,IAC7C,MAAMC,EAAaC,OAAOC,OAAO,CAAE,EAAEH,GAE/BI,EAAWJ,EAAMI,UAAY,UAC5BH,EAAWG,SAElB,MAAMC,GAAaL,EAAMK,WAAa,IAAIC,QAAOC,GAAmB,iBAAP,WACtDN,EAAWI,UAElB,MAAMG,EAAUR,EAAMQ,eACfP,EAAWO,QAEdJ,EAAS/B,QAAU2B,EAAMS,cAC3BL,EAASM,QAAQV,EAAMS,oBAChBR,EAAWQ,aAGhBJ,EAAUhC,QAAU2B,EAAMW,YAC5BN,EAAUK,QAAQV,EAAMW,kBACjBV,EAAWU,WAGpB,MAAMC,EAAKV,OAAOC,OAAOU,SAASf,cAAcC,GAAUE,GAa1D,OAXIG,EAAS/B,QACXuC,EAAGE,mBAAmBV,GAGpBC,EAAUhC,QACZuC,EAAGP,UAAUU,OAAOV,GAGE,iBAAb,GACTH,OAAOC,OAAOS,EAAGJ,QAASA,GAErBI,CACT,CAEO,SAASI,EAA0BjB,EAASkB,KAAQC,GAIpDC,eAAeC,IAAIrB,IACtBoB,eAAeE,OAAOtB,EAASkB,KAAQC,EAE3C,CAEY,MAACI,EAAW9D,GAAMA,EAAES,cAAciB,QAAQ,mBAAoB,KAEnE,SAASqC,EAAkBX,EAAIY,EAASC,GAAiB,GAY9D,MAAM/C,EAAM,CAAA,EACNgD,EAAe,GACrB,IAAK,IAAIC,KAAUH,EAAS,CAC1B,IAAII,EACAnE,MAAMoE,QAAQF,MACfA,EAAQC,GAAgBD,GAE3B,MAAMG,EAAWvE,EAAaoE,GAC9B,GAAKf,EAAGmB,aAAaD,GAOd,CACL,MAAME,EAAYpB,EAAGqB,aAAaH,GAGhCpD,EAAIiD,GAFY,KAAdK,GAIYhD,KAAKkD,MAAMF,EAE5B,WAdsBG,IAAjBP,EACFlD,EAAIiD,GAAUC,GAEdF,EAAaU,KAAKN,GAClBpD,EAAIiD,QAAUQ,EAWnB,CACD,GAAIT,EAAarD,OAAS,GAAKoD,EAE7B,MADAY,QAAQC,KAAK1B,GACP,IAAI7B,MAAM,2CAA2C2C,KAE7D,OAAOhD,CACT"}