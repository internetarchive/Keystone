{"version":3,"file":"arch-dataset-explorer-table.js","sources":["../../../../../web-components/src/archDatasetExplorerTable/src/styles.ts","../../../../../web-components/src/archDatasetExplorerTable/src/arch-dataset-explorer-table.ts"],"sourcesContent":["import { css } from \"lit\";\n\nexport default [\n  css`\n    data-table {\n      min-width: 60rem;\n    }\n\n    data-table > table {\n      table-layout: fixed;\n    }\n\n    data-table > table > thead > tr > th.category {\n      width: 8em;\n    }\n\n    data-table > table > thead > tr > th.sample {\n      width: 7em;\n    }\n\n    data-table > table > thead > tr > th.state {\n      width: 6em;\n    }\n\n    data-table > table > thead > tr > th.started {\n      width: 9em;\n    }\n\n    data-table > table > thead > tr > th.finished {\n      width: 9em;\n    }\n\n    data-table > table > thead > tr > th {\n      max-width: none;\n    }\n\n    span.no-collection-access {\n      cursor: not-allowed;\n      text-decoration: underline;\n    }\n  `,\n];\n","import { PropertyValues } from \"lit\";\nimport { customElement, state } from \"lit/decorators.js\";\n\nimport { ArchDataTable } from \"../../archDataTable/index\";\nimport { BoolDisplayMap, EventTypeDisplayMap } from \"../../lib/constants\";\nimport { Dataset, ProcessingState, ValueOf } from \"../../lib/types\";\nimport {\n  Paths,\n  createElement,\n  isActiveProcessingState,\n  isoStringToDateString,\n} from \"../../lib/helpers\";\nimport Styles from \"./styles\";\n\n@customElement(\"arch-dataset-explorer-table\")\nexport class ArchDatasetExplorerTable extends ArchDataTable<Dataset> {\n  @state() columnNameHeaderTooltipMap = {\n    category:\n      \"Dataset categories are Collection, Network, Text, and File Format\",\n    sample:\n      \"Sample datasets contain only the first 100 available records from a collection\",\n  };\n\n  static styles = [...ArchDataTable.styles, ...Styles];\n\n  static renderNameCell(\n    name: ValueOf<Dataset>,\n    dataset: Dataset\n  ): string | HTMLElement {\n    /*\n     * Render the `Name` cell value.\n     */\n    if (dataset.state !== ProcessingState.FINISHED) {\n      return dataset.name;\n    }\n    return createElement(\"a\", {\n      href: Paths.dataset(dataset.id),\n      children: [\n        createElement(\"span\", {\n          className: \"highlightable\",\n          textContent: dataset.name,\n        }),\n      ],\n    });\n  }\n\n  static renderCollectionCell(\n    collectionName: ValueOf<Dataset>,\n    dataset: Dataset\n  ): HTMLElement {\n    const nameEl = createElement(\"span\", {\n      className: \"highlightable\",\n      textContent: collectionName.toString(),\n    });\n\n    if (!dataset.collection_access) {\n      nameEl.classList.add(\"no-collection-access\");\n      nameEl.title = \"You are not authorized to access this collection\";\n      return nameEl;\n    }\n\n    return createElement(\"a\", {\n      href: Paths.collection(dataset.collection_id),\n      children: [nameEl],\n    });\n  }\n\n  willUpdate(_changedProperties: PropertyValues) {\n    super.willUpdate(_changedProperties);\n\n    this.apiCollectionEndpoint = \"/datasets\";\n    this.apiItemResponseIsArray = true;\n    this.apiItemTemplate = \"/datasets?id=:id\";\n    this.itemPollPredicate = (item) => isActiveProcessingState(item.state);\n    this.itemPollPeriodSeconds = 3;\n    this.apiStaticParamPairs = [];\n    this.cellRenderers = [\n      ArchDatasetExplorerTable.renderNameCell,\n\n      (categoryName) => categoryName as Dataset[\"category_name\"],\n\n      ArchDatasetExplorerTable.renderCollectionCell,\n\n      (isSample) =>\n        BoolDisplayMap[(isSample as Dataset[\"is_sample\"]).toString()],\n\n      (state) => EventTypeDisplayMap[state as Dataset[\"state\"]],\n\n      (startTime) => isoStringToDateString(startTime as Dataset[\"start_time\"]),\n\n      (finishedTime) =>\n        finishedTime === null\n          ? \"\"\n          : isoStringToDateString(finishedTime as Dataset[\"finished_time\"]),\n    ];\n    this.columnFilterDisplayMaps = [\n      undefined,\n      undefined,\n      undefined,\n      BoolDisplayMap,\n    ];\n    this.columns = [\n      \"name\",\n      \"category_name\",\n      \"collection_name\",\n      \"is_sample\",\n      \"state\",\n      \"start_time\",\n      \"finished_time\",\n    ];\n    this.columnHeaders = [\n      \"Dataset\",\n      \"Category\",\n      \"Collection\",\n      \"Sample\",\n      \"State\",\n      \"Started\",\n      \"Finished\",\n    ];\n    this.filterableColumns = [true, true, true, true, true, false, false];\n    this.searchColumns = [\"name\", \"category_name\", \"collection_name\", \"state\"];\n    this.searchColumnLabels = [\"Name\", \"Category\", \"Collection\", \"State\"];\n    this.singleName = \"Dataset\";\n    this.sort = \"-start_time\";\n    this.sortableColumns = [true, true, true, true, true, true, true];\n    this.persistSearchStateInUrl = true;\n    this.pluralName = \"Datasets\";\n  }\n}\n\n// Injects the tag into the global name space\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"arch-dataset-explorer-table\": ArchDatasetExplorerTable;\n  }\n}\n"],"names":["Styles","css","ArchDatasetExplorerTable","ArchDatasetExplorerTable_1","ArchDataTable","constructor","this","columnNameHeaderTooltipMap","category","sample","static","name","dataset","state","ProcessingState","FINISHED","createElement","href","Paths","id","children","className","textContent","collectionName","nameEl","toString","collection_access","collection","collection_id","classList","add","title","willUpdate","_changedProperties","super","apiCollectionEndpoint","apiItemResponseIsArray","apiItemTemplate","itemPollPredicate","item","isActiveProcessingState","itemPollPeriodSeconds","apiStaticParamPairs","cellRenderers","renderNameCell","categoryName","renderCollectionCell","isSample","BoolDisplayMap","EventTypeDisplayMap","startTime","isoStringToDateString","finishedTime","columnFilterDisplayMaps","undefined","columns","columnHeaders","filterableColumns","searchColumns","searchColumnLabels","singleName","sort","sortableColumns","persistSearchStateInUrl","pluralName","styles","__decorate","prototype","customElement"],"mappings":"obAEA,MAAeA,EAAA,CACbC,CAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KCYE,IAAMC,EAAwBC,EAA9B,cAAuCC,EAAvCC,kCACIC,KAAAC,2BAA6B,CACpCC,SACE,oEACFC,OACE,iFA4GL,CAvGCC,sBACEC,EACAC,GAKA,OAAIA,EAAQC,QAAUC,EAAgBC,SAC7BH,EAAQD,KAEVK,EAAc,IAAK,CACxBC,KAAMC,EAAMN,QAAQA,EAAQO,IAC5BC,SAAU,CACRJ,EAAc,OAAQ,CACpBK,UAAW,gBACXC,YAAaV,EAAQD,SAI5B,CAEDD,4BACEa,EACAX,GAEA,MAAMY,EAASR,EAAc,OAAQ,CACnCK,UAAW,gBACXC,YAAaC,EAAeE,aAG9B,OAAKb,EAAQc,kBAMNV,EAAc,IAAK,CACxBC,KAAMC,EAAMS,WAAWf,EAAQgB,eAC/BR,SAAU,CAACI,MAPXA,EAAOK,UAAUC,IAAI,wBACrBN,EAAOO,MAAQ,mDACRP,EAOV,CAEDQ,WAAWC,GACTC,MAAMF,WAAWC,GAEjB3B,KAAK6B,sBAAwB,YAC7B7B,KAAK8B,wBAAyB,EAC9B9B,KAAK+B,gBAAkB,mBACvB/B,KAAKgC,kBAAqBC,GAASC,EAAwBD,EAAK1B,OAChEP,KAAKmC,sBAAwB,EAC7BnC,KAAKoC,oBAAsB,GAC3BpC,KAAKqC,cAAgB,CACnBxC,EAAyByC,eAExBC,GAAiBA,EAElB1C,EAAyB2C,qBAExBC,GACCC,EAAgBD,EAAkCtB,YAEnDZ,GAAUoC,EAAoBpC,GAE9BqC,GAAcC,EAAsBD,GAEpCE,GACkB,OAAjBA,EACI,GACAD,EAAsBC,IAE9B9C,KAAK+C,wBAA0B,MAC7BC,OACAA,OACAA,EACAN,GAEF1C,KAAKiD,QAAU,CACb,OACA,gBACA,kBACA,YACA,QACA,aACA,iBAEFjD,KAAKkD,cAAgB,CACnB,UACA,WACA,aACA,SACA,QACA,UACA,YAEFlD,KAAKmD,kBAAoB,EAAC,GAAM,GAAM,GAAM,GAAM,GAAM,GAAO,GAC/DnD,KAAKoD,cAAgB,CAAC,OAAQ,gBAAiB,kBAAmB,SAClEpD,KAAKqD,mBAAqB,CAAC,OAAQ,WAAY,aAAc,SAC7DrD,KAAKsD,WAAa,UAClBtD,KAAKuD,KAAO,cACZvD,KAAKwD,gBAAkB,EAAC,GAAM,GAAM,GAAM,GAAM,GAAM,GAAM,GAC5DxD,KAAKyD,yBAA0B,EAC/BzD,KAAK0D,WAAa,UACnB,GAxGM9D,EAAM+D,OAAG,IAAI7D,EAAc6D,UAAWjE,GAPpCkE,EAAA,CAARrD,KAKCX,EAAAiE,UAAA,kCAAA,GANSjE,EAAwBC,EAAA+D,EAAA,CADpCE,EAAc,gCACFlE"}