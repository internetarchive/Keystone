{"version":3,"file":"chunk-arch-generate-dataset-form.js","sources":["../../../web-components/src/lib/webservices/node_modules/@lit/reactive-element/decorators/custom-element.js","../../../web-components/src/lib/webservices/node_modules/@lit/reactive-element/decorators/property.js","../../../web-components/src/lib/webservices/node_modules/@lit/reactive-element/decorators/query-assigned-elements.js","../../../../../web-components/src/lib/types.ts","../../../../../web-components/src/lib/webservices/src/aitLoadingSpinner/src/ait-loading-spinner.ts","../../../../../web-components/src/archGenerateDatasetForm/src/arch-job-card.ts","../../../../../web-components/src/archGenerateDatasetForm/src/arch-job-category-section.ts","../../../../../web-components/src/archGenerateDatasetForm/src/styles.ts","../../../../../web-components/src/archGenerateDatasetForm/src/arch-generate-dataset-form.ts"],"sourcesContent":["/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst n=n=>e=>\"function\"==typeof e?((n,e)=>(window.customElements.define(n,e),e))(n,e):((n,e)=>{const{kind:t,elements:i}=e;return{kind:t,elements:i,finisher(e){window.customElements.define(n,e)}}})(n,e);export{n as customElement};\n//# sourceMappingURL=custom-element.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst i=(i,e)=>\"method\"===e.kind&&e.descriptor&&!(\"value\"in e.descriptor)?{...e,finisher(n){n.createProperty(e.key,i)}}:{kind:\"field\",key:Symbol(),placement:\"own\",descriptor:{},originalKey:e.key,initializer(){\"function\"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(n){n.createProperty(e.key,i)}};function e(e){return(n,t)=>void 0!==t?((i,e,n)=>{e.constructor.createProperty(n,i)})(e,n,t):i(e,n)}export{e as property};\n//# sourceMappingURL=property.js.map\n","import{decorateProperty as o}from\"./base.js\";\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */var n;const e=null!=(null===(n=window.HTMLSlotElement)||void 0===n?void 0:n.prototype.assignedElements)?(o,n)=>o.assignedElements(n):(o,n)=>o.assignedNodes(n).filter((o=>o.nodeType===Node.ELEMENT_NODE));function l(n){const{slot:l,selector:t}=null!=n?n:{};return o({descriptor:o=>({get(){var o;const r=\"slot\"+(l?`[name=${l}]`:\":not([name])\"),i=null===(o=this.renderRoot)||void 0===o?void 0:o.querySelector(r),s=null!=i?e(i,n):[];return t?s.filter((o=>o.matches(t))):s},enumerable:!0,configurable:!0})})}export{l as queryAssignedElements};\n//# sourceMappingURL=query-assigned-elements.js.map\n","import { JSONSchemaType } from \"ajv\";\nimport { SomeJSONSchema } from \"ajv/lib/types/json-schema\";\n\nexport enum ProcessingState {\n  SUBMITTED = \"SUBMITTED\",\n  QUEUED = \"QUEUED\",\n  RUNNING = \"RUNNING\",\n  FINISHED = \"FINISHED\",\n  FAILED = \"FAILED\",\n  CANCELLED = \"CANCELLED\",\n}\n\nexport type AITCollectionMetadata = {\n  is_public?: boolean;\n  num_seeds?: number;\n  last_crawl_date?: Date;\n};\n\nexport type CustomCollectionMetadata = {\n  state: ProcessingState;\n};\n\nexport enum CollectionType {\n  AIT = \"AIT\",\n  SPECIAL = \"SPECIAL\",\n  CUSTOM = \"CUSTOM\",\n}\n\nexport type Collection = {\n  id: number;\n  name: string;\n  collection_type: CollectionType;\n  size_bytes: number;\n  dataset_count: number;\n  latest_dataset: {\n    id: number;\n    name: string;\n    start_time: Date;\n  };\n  metadata: AITCollectionMetadata | CustomCollectionMetadata;\n};\n\nexport interface CollectionSearchResult {\n  organizationId: number;\n  organizationName: string;\n  collectionName: string;\n  collectionId: number;\n  meta_Description?: string;\n  totalWarcBytes: number;\n}\n\nexport interface CollectionCheckboxEventDetail {\n  collectionSize: string;\n  isChecked: boolean;\n  collectionName: string;\n  collectionId: string;\n}\n\nexport interface CollectionSelectedDetail {\n  collectionSize: string;\n  collectionId: string;\n}\n\nexport interface Facets {\n  [key: string]: Array<string | number>;\n}\n\nexport interface FacetResultMap {\n  name: string;\n  count: number;\n}\n\nexport interface CollectionRemovedFromCartDetail {\n  collectionName: string;\n}\n\nexport type Dataset = {\n  category_name: string;\n  collection_id: number;\n  collection_name: string;\n  finished_time: Date;\n  id: string;\n  is_sample: boolean;\n  job_id: string;\n  name: string;\n  start_time: Date;\n  state: ProcessingState;\n};\n\n// Datasets objects are also used to convey job state.\nexport type JobState = Dataset;\n\nexport enum JobId {\n  ArsLgaGeneration = \"ArsLgaGeneration\",\n  ArsWaneGeneration = \"ArsWaneGeneration\",\n  ArsWatGeneration = \"ArsWatGeneration\",\n  AudioInformationExtraction = \"AudioInformationExtraction\",\n  DomainFrequencyExtraction = \"DomainFrequencyExtraction\",\n  DomainGraphExtraction = \"DomainGraphExtraction\",\n  ImageGraphExtraction = \"ImageGraphExtraction\",\n  ImageInformationExtraction = \"ImageInformationExtraction\",\n  PdfInformationExtraction = \"PdfInformationExtraction\",\n  PresentationProgramInformationExtraction = \"PresentationProgramInformationExtraction\",\n  SpreadsheetInformationExtraction = \"SpreadsheetInformationExtraction\",\n  TextFilesInformationExtraction = \"TextFilesInformationExtraction\",\n  VideoInformationExtraction = \"VideoInformationExtraction\",\n  WebGraphExtraction = \"WebGraphExtraction\",\n  WebPagesExtraction = \"WebPagesExtraction\",\n  WordProcessorInformationExtraction = \"WordProcessorInformationExtraction\",\n}\n\nexport type AvailableJob = {\n  id: JobId;\n  name: string;\n  description: string;\n};\n\nexport type AvailableJobsCategory = {\n  categoryName: string;\n  categoryDescription: string;\n  categoryImage: string;\n  categoryId: string;\n  jobs: Array<AvailableJob>;\n};\n\nexport type AvailableJobs = Array<AvailableJobsCategory>;\n\nexport type PublishedDatasetInfo = {\n  item: string;\n  source: string;\n  collection: string;\n  job: JobId;\n  complete: boolean;\n  sample: boolean;\n  time: Date;\n  ark: string;\n};\n\nexport type PublishedDatasetMetadataApiResponse = {\n  creator?: Array<string>;\n  description?: Array<string>;\n  licenseurl?: Array<string>;\n  subject?: Array<string>;\n  title?: Array<string>;\n};\n\nexport type PublishedDatasetMetadata = {\n  creator?: Array<string>;\n  description?: string;\n  licenseurl?: string;\n  subject?: Array<string>;\n  title?: string;\n};\n\nexport type PublishedDatasetMetadataValue =\n  PublishedDatasetMetadata[keyof PublishedDatasetMetadata];\n\nexport type PublishedDatasetMetadataJSONSchema =\n  JSONSchemaType<PublishedDatasetMetadata>;\n\nexport type PublishedDatasetMetadataJSONSchemaProps = Record<\n  keyof PublishedDatasetMetadata,\n  SomeJSONSchema\n>;\n\n// API Types\n\nexport type BaseFilteredApiResponse<T> = {\n  count: number;\n  items: T;\n};\n\ntype FilteredApiResults<T> = Array<T>;\n\ntype DistinctApiResults<T> = Array<T[keyof T]>;\n\nexport type FilteredApiResponse<T> = BaseFilteredApiResponse<\n  FilteredApiResults<T>\n>;\n\nexport type DistinctApiResponse<T> = BaseFilteredApiResponse<\n  DistinctApiResults<T>\n>;\n\nexport type ApiResponse<T> = FilteredApiResponse<T> | DistinctApiResponse<T>;\n\ntype ApiParamOp = \"=\" | \"!=\";\n\ntype ApiFilterKey = \"distinct\" | \"limit\" | \"offset\" | \"search\" | \"sort\";\n\nexport type ApiParams<T> = Array<\n  [keyof T | ApiFilterKey, ApiParamOp, string | number | boolean]\n>;\n\nexport type ApiPath = \"/collections\" | \"/datasets\";\n","import { html, css, LitElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\n\n@customElement(\"ait-loading-spinner\")\nexport class AitLoadingSpinner extends LitElement {\n  @property({ type: Number }) widthPx = 24;\n  @property({ type: Number }) heightPx = 24;\n\n  render() {\n    const { widthPx, heightPx } = this;\n    return html`\n      <style>\n        .loading-spinner {\n          width: ${widthPx}px;\n          height: ${heightPx}px;\n        }\n\n        .loading-spinner div {\n          transform-origin: ${widthPx / 2}px ${heightPx / 2}px;\n        }\n\n        .loading-spinner div:after {\n          top: ${heightPx * 0.0375}px;\n          left: ${widthPx * 0.4625}px;\n          width: ${widthPx * 0.075}px;\n          height: ${heightPx * 0.225}px;\n        }\n      </style>\n\n      <div class=\"loading-spinner\">\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n      </div>\n    `;\n  }\n\n  static styles = css`\n    .loading-spinner {\n      display: inline-block;\n      position: relative;\n    }\n    .loading-spinner div {\n      animation: lds-spinner 1.2s linear infinite;\n    }\n    .loading-spinner div:after {\n      content: \" \";\n      display: block;\n      position: absolute;\n      border-radius: 20%;\n      background: var(--ait-loading-spinner-color, #fff);\n    }\n    .loading-spinner div:nth-child(1) {\n      transform: rotate(0deg);\n      animation-delay: -1.1s;\n    }\n    .loading-spinner div:nth-child(2) {\n      transform: rotate(30deg);\n      animation-delay: -1s;\n    }\n    .loading-spinner div:nth-child(3) {\n      transform: rotate(60deg);\n      animation-delay: -0.9s;\n    }\n    .loading-spinner div:nth-child(4) {\n      transform: rotate(90deg);\n      animation-delay: -0.8s;\n    }\n    .loading-spinner div:nth-child(5) {\n      transform: rotate(120deg);\n      animation-delay: -0.7s;\n    }\n    .loading-spinner div:nth-child(6) {\n      transform: rotate(150deg);\n      animation-delay: -0.6s;\n    }\n    .loading-spinner div:nth-child(7) {\n      transform: rotate(180deg);\n      animation-delay: -0.5s;\n    }\n    .loading-spinner div:nth-child(8) {\n      transform: rotate(210deg);\n      animation-delay: -0.4s;\n    }\n    .loading-spinner div:nth-child(9) {\n      transform: rotate(240deg);\n      animation-delay: -0.3s;\n    }\n    .loading-spinner div:nth-child(10) {\n      transform: rotate(270deg);\n      animation-delay: -0.2s;\n    }\n    .loading-spinner div:nth-child(11) {\n      transform: rotate(300deg);\n      animation-delay: -0.1s;\n    }\n    .loading-spinner div:nth-child(12) {\n      transform: rotate(330deg);\n      animation-delay: 0s;\n    }\n    @keyframes lds-spinner {\n      0% {\n        opacity: 1;\n      }\n      100% {\n        opacity: 0;\n      }\n    }\n  `;\n}\n","import { LitElement, html } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\nimport { unsafeHTML } from \"lit-html/directives/unsafe-html.js\";\n\nimport \"../../lib/webservices/src/aitLoadingSpinner/index\";\n\nimport { AvailableJob, JobState, ProcessingState } from \"../../lib/types\";\n\nexport enum JobButtonType {\n  Generate = \"generate\",\n  View = \"view\",\n  Status = \"status\",\n}\n\n@customElement(\"arch-job-card\")\nexport class ArchJobCard extends LitElement {\n  @property() collectionId!: string;\n  @property() job!: AvailableJob;\n  @property() jobIdStatesMap!: Record<string, JobState>;\n\n  createRenderRoot() {\n    /* Disable the shadow root for this component to let in global styles.\n       https://stackoverflow.com/a/55213037 */\n    return this;\n  }\n\n  private jobStateToButtonProps(\n    jobState: JobState | undefined | null,\n    sample: boolean\n  ) {\n    /* Return the [ButtonText, ButtonType, ClassName] tuple for the specificed JobState */\n    if (jobState === undefined) {\n      return [\n        this.collectionId ? \"Loading...\" : \"n/a\",\n        JobButtonType.Status,\n        \"job-statebutton\",\n      ];\n    }\n    const sampleStr = sample ? \"Sample \" : \"\";\n    if (jobState === null) {\n      return [\n        `Generate ${sampleStr}Dataset`,\n        JobButtonType.Generate,\n        \"job-runbutton\",\n      ];\n    }\n    if (jobState.state === ProcessingState.SUBMITTED) {\n      return [\n        `Starting&nbsp;<ait-loading-spinner style=\"position: absolute; --ait-loading-spinner-color: #2991CC\"></ait-loading-spinner>`,\n        JobButtonType.Status,\n        \"job-statebutton\",\n      ];\n    }\n    if (jobState.state === ProcessingState.FINISHED) {\n      return [\n        `View ${sampleStr}Dataset`,\n        JobButtonType.View,\n        \"job-resultsbutton\",\n      ];\n    }\n    return [jobState.state, JobButtonType.Status, \"job-statebutton\"];\n  }\n\n  render() {\n    // Get the current job states.\n    const { collectionId, job } = this;\n    const { id: jobId } = job;\n    // Use undefined to indicate that a job state is loading, and null to\n    // indicate that no such job run exists.\n    const [sampleJobState, jobState] = !this.jobIdStatesMap\n      ? [undefined, undefined]\n      : [\n          this.jobIdStatesMap[`${jobId}-SAMPLE`] ?? null,\n          this.jobIdStatesMap[jobId] ?? null,\n        ];\n    const [sampleButtonHTML, sampleButtonType, sampleClassName] =\n      this.jobStateToButtonProps(sampleJobState, true);\n    const [buttonHTML, buttonType, className] = this.jobStateToButtonProps(\n      jobState,\n      false\n    );\n    const title = collectionId\n      ? \"\"\n      : \"Select a source collection to enable this button\";\n    return html` <div class=\"card\">\n      <div class=\"card-body\">\n        <h2 class=\"card-title\">${job.name}</h2>\n        <p class=\"card-text\">${job.description}</p>\n        <div class=\"job-card-flex\">\n          <div class=\"job-card-sample\">\n            ${sampleButtonType === JobButtonType.View\n              ? html`\n                  <a\n                    href=\"/datasets/${(sampleJobState as JobState).id}\"\n                    class=\"button ${sampleClassName}\"\n                  >\n                    ${unsafeHTML(sampleButtonHTML)}\n                  </a>\n                `\n              : html`\n                  <button\n                    class=\"job-button ${sampleClassName}\"\n                    style=\"display: block\"\n                    data-job-id=\"${jobId}\"\n                    data-button-type=\"${sampleButtonType}\"\n                    data-sample=\"\"\n                    title=\"${title}\"\n                  >\n                    ${unsafeHTML(sampleButtonHTML)}\n                  </button>\n                `}\n          </div>\n          <div class=\"job-card-full\">\n            ${buttonType === JobButtonType.View\n              ? html`\n                  <a\n                    href=\"/datasets/${(jobState as JobState).id}\"\n                    class=\"button ${className}\"\n                  >\n                    ${unsafeHTML(buttonHTML)}\n                  </a>\n                `\n              : html`\n                  <button\n                    class=\"job-button ${className}\"\n                    style=\"display: block\"\n                    data-job-id=\"${jobId}\"\n                    data-button-type=\"${buttonType}\"\n                    title=\"${title}\"\n                  >\n                    ${unsafeHTML(buttonHTML)}\n                  </button>\n                `}\n          </div>\n        </div>\n      </div>\n    </div>`;\n  }\n}\n\n// Injects the tag into the global name space\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"arch-job-card\": ArchJobCard;\n  }\n}\n","import { LitElement, html } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\n\nimport { AvailableJobsCategory, JobState } from \"../../lib/types\";\n\nimport \"./arch-job-card\";\n\n@customElement(\"arch-job-category-section\")\nexport class ArchJobCategorySection extends LitElement {\n  @property({ type: Boolean }) collapsed = false;\n  @property({ type: String }) collectionId!: string;\n  @property({ type: Object }) jobsCat!: AvailableJobsCategory;\n  @property({ type: Object }) jobIdStatesMap!: Record<string, JobState>;\n\n  createRenderRoot() {\n    /* Disable the shadow root for this component to let in global styles.\n       https://stackoverflow.com/a/55213037 */\n    return this;\n  }\n\n  expand() {\n    this.collapsed = false;\n  }\n\n  collapse() {\n    this.collapsed = true;\n  }\n\n  render() {\n    return html`\n      <div class=\"job-category ${this.collapsed ? \"collapsed\" : \"expanded\"}\">\n        <button\n          class=\"category-accordian-button\"\n          aria-controls=${this.jobsCat.categoryName}\n          aria-expanded=\"${this.collapsed ? \"false\" : \"true\"}\"\n        >\n          <img\n            class=\"category-image\"\n            src=\"${this.jobsCat.categoryImage}\"\n            alt=\"Icon for ${this.jobsCat.categoryName}\"\n          />\n          <span id=\"${this.jobsCat.categoryId}\" class=\"category-title\">\n            ${this.jobsCat.categoryName}\n          </span>\n          <br />\n          <span class=\"category-description\">\n            ${this.jobsCat.categoryDescription}\n          </span>\n        </button>\n        <div id=${this.jobsCat.categoryName} class=\"collapsible-content\">\n          ${this.jobsCat.jobs.map(\n            (job) => html`\n              <arch-job-card\n                .collectionId=${this.collectionId}\n                .job=${job}\n                .jobIdStatesMap=${this.jobIdStatesMap}\n              >\n              </arch-job-card>\n            `\n          )}\n        </div>\n      </div>\n    `;\n  }\n}\n\n// Injects the tag into the global name space\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"arch-job-category-section\": ArchJobCategorySection;\n  }\n}\n","import { css } from \"lit\";\n\nexport default css``;\n","import { LitElement, html } from \"lit\";\nimport {\n  customElement,\n  property,\n  query,\n  queryAll,\n  state,\n} from \"lit/decorators.js\";\n\nimport ArchAPI from \"../../lib/ArchAPI\";\nimport {\n  AvailableJob,\n  AvailableJobs,\n  AvailableJobsCategory,\n  Collection,\n  JobState,\n  FilteredApiResponse,\n  ProcessingState,\n} from \"../../lib/types\";\nimport { AlertClass, ArchAlert } from \"../../archAlert/index\";\nimport \"./arch-job-category-section\";\nimport { ArchJobCategorySection } from \"./arch-job-category-section\";\nimport { ArchJobCard, JobButtonType } from \"./arch-job-card\";\n\nimport Styles from \"./styles\";\n\n// Define the display order of known categories and jobs.\nconst sortedCatNames = [\"Collection\", \"Network\", \"Text\", \"File Formats\"];\n\nconst catNameSortedJobNamesMap: Record<\n  AvailableJobsCategory[\"categoryName\"],\n  Array<AvailableJob[\"name\"]>\n> = {\n  Collection: [\"Domain frequency\", \"Web archive transformation (WAT)\"],\n  Network: [\"Domain graph\", \"Image graph\", \"Longitudinal graph\", \"Web graph\"],\n  Text: [\"Named entities\", \"Plain text of webpages\", \"Text file information\"],\n  \"File Formats\": [\n    \"Audio file information\",\n    \"Image file information\",\n    \"PDF file information\",\n    \"Presentation file information\",\n    \"Spreadsheet file information\",\n    \"Video file information\",\n    \"Word processing file information\",\n  ],\n};\n\n@customElement(\"arch-generate-dataset-form\")\nexport class ArchGenerateDatasetForm extends LitElement {\n  @property({ type: String }) csrfToken!: string;\n\n  @state() collections: null | Array<Collection> = null;\n  @state() availableJobs: AvailableJobs = [];\n  @state() sourceCollectionId: Collection[\"id\"] | null = null;\n  @state() collectionJobStates: Record<\n    Collection[\"id\"],\n    Record<string, JobState>\n  > = {};\n  @state() activePollCollectionId: Collection[\"id\"] | null = null;\n  @state() anyErrors = false;\n\n  @query(\"select[name=source-collection]\")\n  collectionSelector!: HTMLSelectElement;\n  @query(\"arch-alert.error\") errorAlert!: ArchAlert;\n  @query(\"arch-alert.email\") emailAlert!: ArchAlert;\n  @queryAll(\"arch-job-category-section\")\n  categorySections!: Array<ArchJobCategorySection>;\n\n  // Apply any ARCH-specific styles.\n  static styles = Styles;\n\n  static urlCollectionParamName = \"cid\";\n\n  async connectedCallback() {\n    // Fetch available Collections and Jobs.\n    await this.initAvailableJobs();\n    void this.initCollections();\n    super.connectedCallback();\n    this.addEventListener(\"click\", (e: Event) => void this.clickHandler(e));\n  }\n\n  createRenderRoot() {\n    /* Disable the shadow root for this component to let in global styles.\n       https://stackoverflow.com/a/55213037 */\n    return this;\n  }\n\n  render() {\n    const jobIdStatesMap =\n      this.sourceCollectionId &&\n      this.collectionJobStates[this.sourceCollectionId];\n    return html`\n      <label for=\"source-collection\">Select Source Collection</label>\n      <select\n        name=\"source-collection\"\n        @change=${this.sourceCollectionChangeHandler}\n        ?disabled=${this.collections === null}\n      >\n        ${this.collections === null\n          ? html`<option>Loading...</option>`\n          : html`<option value=\"\">~ Choose Source Collection ~</option>`}\n        ${(this.collections ?? []).map(\n          (collection) => html`\n            <option\n              value=\"${collection.id}\"\n              ?selected=${collection.id === this.sourceCollectionId}\n            >\n              ${collection.name}\n            </option>\n          `\n        )}\n      </select>\n\n      <arch-alert\n        class=\"sample\"\n        alertClass=${AlertClass.Secondary}\n        message=\"Sample datasets can be quickly generated in order to ensure that the analysis will produce datasets that meet your needs. These datasets use the first 100 relative records from the collection if they are available. We strongly recommend generating samples for any collections over 100GB.\"\n      ></arch-alert>\n\n      <arch-alert\n        class=\"email\"\n        alertClass=${AlertClass.Primary}\n        message=\"ARCH is creating your dataset. You will receive an email notification when the dataset is complete.\"\n        hidden\n      ></arch-alert>\n\n      <arch-alert\n        class=\"error\"\n        alertClass=${AlertClass.Danger}\n        message=\"A dataset generation job has failed, and we are currently investigating it.\"\n        ?hidden=${!this.anyErrors}\n      ></arch-alert>\n\n      ${this.availableJobs.map(\n        (jobsCat, i) => html`\n          <arch-job-category-section\n            .collectionId=${this.sourceCollectionId}\n            .jobsCat=${jobsCat}\n            .jobIdStatesMap=${jobIdStatesMap}\n            ?collapsed=${i > 0}\n          >\n          </arch-job-category-section>\n        `\n      )}\n    `;\n  }\n\n  private setCollectionIdUrlParam(collectionId: Collection[\"id\"]) {\n    const { urlCollectionParamName } = ArchGenerateDatasetForm;\n    const url = new URL(window.location.href);\n    if (!collectionId) {\n      url.searchParams.delete(urlCollectionParamName);\n    } else {\n      url.searchParams.set(urlCollectionParamName, collectionId.toString());\n    }\n    history.replaceState(null, \"\", url.toString());\n  }\n\n  private async sourceCollectionChangeHandler(e: Event) {\n    const collectionId = parseInt((e.target as HTMLSelectElement).value);\n    this.setCollectionIdUrlParam(collectionId);\n    await this.setSourceCollectionId(collectionId);\n    this.requestUpdate();\n  }\n\n  private updateAnyErrors() {\n    /* If collectionId is set, set anyErrors=true if any job failed, otherwise set\n     * anyErrors=false\n     */\n    const { sourceCollectionId } = this;\n    if (sourceCollectionId) {\n      for (const jobState of Object.values(\n        this.collectionJobStates[sourceCollectionId]\n      )) {\n        if (jobState.state === ProcessingState.FAILED) {\n          this.anyErrors = true;\n          return;\n        }\n      }\n    }\n    this.anyErrors = false;\n  }\n\n  private async setSourceCollectionId(collectionId: Collection[\"id\"]) {\n    this.sourceCollectionId = collectionId;\n    // If a collection is selected, fetch the job states.\n    if (collectionId) {\n      this.collectionJobStates[collectionId] =\n        await this.fetchCollectionJobStates(collectionId);\n    }\n    // Update the visibility of the error alert.\n    this.updateAnyErrors();\n  }\n\n  private async initCollections() {\n    const response =\n      (await ArchAPI.collections.get()) as FilteredApiResponse<Collection>;\n    this.collections = response.items;\n    // Maybe select an initial Collection.\n    const initialCollectionId = parseInt(\n      new URLSearchParams(window.location.search).get(\n        ArchGenerateDatasetForm.urlCollectionParamName\n      ) ?? \"\"\n    );\n    if (!Number.isNaN(initialCollectionId)) {\n      await this.setSourceCollectionId(initialCollectionId);\n      this.requestUpdate();\n    }\n  }\n\n  private async initAvailableJobs() {\n    const availableJobs = (await (\n      await fetch(\"/api/available-jobs\")\n    ).json()) as AvailableJobs;\n    // Apply the desired display order.\n    availableJobs\n      .sort((a, b) =>\n        sortedCatNames.indexOf(a.categoryName) >\n        sortedCatNames.indexOf(b.categoryName)\n          ? 1\n          : -1\n      )\n      .map((jobCat) => {\n        jobCat.jobs.sort((a, b) => {\n          const sortedJobNames = catNameSortedJobNamesMap[jobCat.categoryName];\n          return sortedJobNames === undefined\n            ? 0\n            : sortedJobNames.indexOf(a.name) > sortedJobNames.indexOf(b.name)\n            ? 1\n            : -1;\n        });\n        return jobCat;\n      });\n    this.availableJobs = availableJobs;\n  }\n\n  private async fetchCollectionJobStates(collectionId: Collection[\"id\"]) {\n    const jobStates = (await (\n      await fetch(`/api/collections/${collectionId}/dataset_states`)\n    ).json()) as Array<JobState>;\n    return Object.fromEntries(\n      jobStates.map((jobState) => [\n        `${jobState.job_id}${jobState.is_sample ? \"-SAMPLE\" : \"\"}`,\n        jobState,\n      ])\n    ) as Record<string, JobState>;\n  }\n\n  async pollJobStates() {\n    const { sourceCollectionId } = this;\n    // Stop polling if the selected collection has changed.\n    if (\n      sourceCollectionId === null ||\n      this.activePollCollectionId !== sourceCollectionId\n    ) {\n      this.activePollCollectionId = null;\n      return;\n    }\n    // Fetch the current collection job states.\n    this.collectionJobStates[sourceCollectionId] =\n      await this.fetchCollectionJobStates(sourceCollectionId);\n    // Show the error alert if any jobs failed.\n    this.updateAnyErrors();\n    // Request a lit component update.\n    this.requestUpdate();\n    // Keep polling if any jobs remain active.\n    for (const jobState of Object.values(\n      this.collectionJobStates[sourceCollectionId]\n    )) {\n      if (jobState.state === ProcessingState.RUNNING) {\n        // A job is active, set a polling timeout and return.\n        setTimeout(() => void this.pollJobStates(), 2000);\n        return;\n      }\n    }\n    // No jobs remain active, so stop polling.\n    this.activePollCollectionId = null;\n  }\n\n  private startPolling() {\n    // Abort if polling is already active.\n    if (this.activePollCollectionId !== null) {\n      return;\n    }\n    this.activePollCollectionId = this.sourceCollectionId;\n    void this.pollJobStates();\n  }\n\n  private expandCategorySection(categorySection: ArchJobCategorySection) {\n    this.categorySections.forEach((el) => {\n      if (el === categorySection) {\n        el.expand();\n      } else {\n        el.collapse();\n      }\n    });\n  }\n\n  private async runJob(jobId: string, sample: boolean) {\n    return fetch(\"/api/datasets/generate\", {\n      method: \"POST\",\n      credentials: \"same-origin\",\n      headers: { \"X-CSRFToken\": this.csrfToken },\n      mode: \"cors\",\n      body: JSON.stringify({\n        collection_id: this.sourceCollectionId,\n        job_type_id: jobId,\n        is_sample: sample,\n      }),\n    });\n  }\n\n  private async clickHandler(e: Event) {\n    const target = e.target as HTMLElement;\n    // Handle a collapsed category section click.\n    const categorySection = target.closest(\"arch-job-category-section\");\n    if (categorySection?.collapsed) {\n      this.expandCategorySection(categorySection);\n      return;\n    }\n\n    // Handle a job button click.\n    if (\n      target.tagName === \"BUTTON\" &&\n      target.dataset.buttonType === JobButtonType.Generate\n    ) {\n      // Disable the button and display the starting... indicator.\n      const button = target as HTMLButtonElement;\n      button.disabled = true;\n      const { jobId, sample: sampleStr } = target.dataset as {\n        jobId: string;\n        sample: string;\n      };\n      // Cast presence / absence of sample value to bool.\n      const sample = sampleStr !== undefined;\n      // Update the internal state of this job to SUBMITTED.\n      const { collectionJobStates } = this;\n      let { sourceCollectionId } = this;\n      sourceCollectionId = sourceCollectionId as Collection[\"id\"];\n      const jobStateKey = `${jobId}${sample ? \"-SAMPLE\" : \"\"}`;\n      const jobStates = collectionJobStates[sourceCollectionId];\n      // Create a synthetic/dummy JobState object with state = SUBMITTED in order to\n      // cause the ArchJobCard button to update its displayed text. This object will\n      // be overwritten with a real JobState object once polling starts.\n      jobStates[jobStateKey] = {\n        category_name: \"\",\n        collection_id: sourceCollectionId,\n        collection_name: \"\",\n        finished_time: new Date(),\n        id: \"\",\n        is_sample: sample,\n        job_id: jobId,\n        name: \"\",\n        start_time: new Date(),\n        state: ProcessingState.SUBMITTED,\n      };\n      // Request a manual re-render.\n      const archJobCard = target.closest(\"arch-job-card\") as ArchJobCard;\n      archJobCard.requestUpdate();\n      // Make the request.\n      const res = await this.runJob(jobId, sample);\n      if (!res.ok) {\n        // Re-enable the button on error.\n        button.disabled = false;\n        // Delete the synthetic JobState object and request a manual re-render.\n        delete jobStates[jobStateKey];\n        archJobCard.requestUpdate();\n        return;\n      }\n      this.emailAlert.show();\n      this.startPolling();\n    }\n  }\n}\n\n// Injects the tag into the global name space\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"arch-generate-dataset-form\": ArchGenerateDatasetForm;\n  }\n}\n"],"names":["n","e","window","customElements","define","kind","t","elements","i","finisher","descriptor","createProperty","key","Symbol","placement","originalKey","initializer","this","call","constructor","ProcessingState","CollectionType","JobId","HTMLSlotElement","prototype","assignedElements","AitLoadingSpinner","LitElement","widthPx","heightPx","render","html","JobButtonType","styles","css","__decorate","property","type","Number","customElement","ArchJobCard","createRenderRoot","jobStateToButtonProps","jobState","sample","undefined","collectionId","Status","sampleStr","Generate","state","SUBMITTED","FINISHED","View","job","id","jobId","sampleJobState","jobIdStatesMap","_a","_b","sampleButtonHTML","sampleButtonType","sampleClassName","buttonHTML","buttonType","className","title","name","description","unsafeHTML","ArchJobCategorySection","collapsed","expand","collapse","jobsCat","categoryName","categoryImage","categoryId","categoryDescription","jobs","map","Boolean","String","Object","sortedCatNames","catNameSortedJobNamesMap","Collection","Network","Text","ArchGenerateDatasetForm","ArchGenerateDatasetForm_1","collections","availableJobs","sourceCollectionId","collectionJobStates","activePollCollectionId","anyErrors","async","initAvailableJobs","initCollections","super","connectedCallback","addEventListener","clickHandler","sourceCollectionChangeHandler","collection","AlertClass","Secondary","Primary","Danger","setCollectionIdUrlParam","urlCollectionParamName","url","URL","location","href","searchParams","set","toString","delete","history","replaceState","parseInt","target","value","setSourceCollectionId","requestUpdate","updateAnyErrors","values","FAILED","fetchCollectionJobStates","response","ArchAPI","get","items","initialCollectionId","URLSearchParams","search","isNaN","fetch","json","sort","a","b","indexOf","jobCat","sortedJobNames","jobStates","fromEntries","job_id","is_sample","RUNNING","setTimeout","pollJobStates","startPolling","expandCategorySection","categorySection","categorySections","forEach","el","method","credentials","headers","csrfToken","mode","body","JSON","stringify","collection_id","job_type_id","closest","tagName","dataset","button","disabled","jobStateKey","category_name","collection_name","finished_time","Date","start_time","archJobCard","runJob","ok","emailAlert","show","Styles","query","queryAll"],"mappings":"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"}