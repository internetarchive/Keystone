{"version":3,"file":"arch-collections-card.js","sources":["../../../../../web-components/src/archCollectionsCard/src/styles.ts","../../../../../web-components/src/archCollectionsCard/src/arch-collections-card.ts"],"sourcesContent":["import { css } from \"lit\";\n\nimport { global, cardTable } from \"../../lib/styles\";\n\nexport default [\n  global,\n  cardTable,\n  css`\n    thead > tr.hidden-header {\n      color: transparent;\n    }\n\n    th.size,\n    th.num-datasets {\n      text-align: right;\n    }\n\n    th.size {\n      width: 7rem;\n    }\n\n    th.num-datasets {\n      width: 10rem;\n    }\n\n    td.name {\n      text-overflow: ellipsis;\n      white-space: nowrap;\n      overflow-x: hidden;\n    }\n\n    td.size,\n    td.num-datasets {\n      text-align: right;\n    }\n  `,\n];\n","import { LitElement, html } from \"lit\";\nimport { customElement, state } from \"lit/decorators.js\";\n\nimport ArchAPI from \"../../lib/ArchAPI\";\nimport { Collection } from \"../../lib/types\";\nimport { Paths, humanBytes } from \"../../lib/helpers\";\n\nimport \"../../archCard/index\";\nimport \"../../archLoadingIndicator/index\";\n\nimport styles from \"./styles\";\n\n@customElement(\"arch-collections-card\")\nexport class ArchCollectionsCard extends LitElement {\n  @state() numTotalCollections = 0;\n  @state() collections: undefined | Array<Collection> = undefined;\n\n  static maxDisplayedCollections = 10;\n  static styles = styles;\n\n  constructor() {\n    super();\n    void this.initCollections();\n  }\n\n  render() {\n    const { maxDisplayedCollections } = ArchCollectionsCard;\n    const isLoading = this.collections === undefined;\n    // Note that the value of hasCollection is only valid when isLoading=false;\n    const hasCollections = this.numTotalCollections > 0;\n    const getRows = () =>\n      isLoading\n        ? [\n            html`\n              <tr>\n                <td colspan=\"3\">\n                  <arch-loading-indicator></arch-loading-indicator>\n                </td>\n              </tr>\n            `,\n          ]\n        : !hasCollections\n        ? [\n            html`\n              <tr>\n                <td colspan=\"3\">\n                  <i\n                    >No collections found.\n                    <a\n                      href=\"https://arch-webservices.zendesk.com/hc/en-us/articles/14795196010772\"\n                      >Contact us</a\n                    >\n                    to access collections or report an error.</i\n                  >\n                </td>\n              </tr>\n            `,\n          ]\n        : (this.collections ?? []).slice(0, maxDisplayedCollections).map(\n            (collection) => html`\n              <tr>\n                <td class=\"name\">\n                  <a\n                    href=\"/collections/${collection.id}\"\n                    title=\"${collection.name}\"\n                  >\n                    ${collection.name}\n                  </a>\n                </td>\n                <td class=\"size\">${humanBytes(collection.size_bytes, 1)}</td>\n                <td class=\"num-datasets\">\n                  ${collection.dataset_count} Datasets\n                </td>\n              </tr>\n            `\n          );\n    return html`\n      <arch-card\n        title=\"Collections\"\n        ctatext=${!isLoading && hasCollections\n          ? \"Create Custom Collection\"\n          : \"\"}\n        ctahref=\"${Paths.buildSubCollection()}\"\n        ctaTooltipHeader=\"Custom Collection\"\n        ctaTooltipText=\"Combine and filter your collections into a Custom Collection of only the data you need.\"\n        ctaTooltipLearnMoreUrl=\"https://arch-webservices.zendesk.com/hc/en-us/articles/16107865758228-How-to-create-a-custom-ARCH-collection\"\n      >\n        <div slot=\"content\">\n          <table>\n            <thead>\n              <tr\n                class=\"${isLoading || !hasCollections ? \"hidden-header\" : \"\"}\"\n              >\n                <th class=\"name\">Collection Name</th>\n                <th class=\"size\">Collection Size</th>\n                <th class=\"num-datasets\">Generated Datasets</th>\n              </tr>\n            </thead>\n            <tbody>\n              ${getRows()}\n            </tbody>\n          </table>\n        </div>\n        <div slot=\"footer\">\n          ${isLoading || !hasCollections\n            ? html``\n            : html`\n                <a href=\"/collections\" class=\"view-all\">\n                  View\n                  ${this.numTotalCollections > maxDisplayedCollections\n                    ? html`All ${this.numTotalCollections}`\n                    : html``}\n                  Collections\n                </a>\n              `}\n        </div>\n      </arch-card>\n    `;\n  }\n\n  private async initCollections() {\n    const response = await ArchAPI.collections.get([\n      // TODO\n      //      [\"sort\", \"=\", \"-lastJobTime\"],\n      [\"limit\", \"=\", ArchCollectionsCard.maxDisplayedCollections],\n    ]);\n    this.numTotalCollections = response.count;\n    this.collections = response.items;\n  }\n}\n\n// Injects the tag into the global name space\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"arch-collections-card\": ArchCollectionsCard;\n  }\n}\n"],"names":["styles","global","cardTable","css","ArchCollectionsCard","ArchCollectionsCard_1","LitElement","constructor","super","this","numTotalCollections","collections","undefined","initCollections","render","maxDisplayedCollections","isLoading","hasCollections","html","Paths","buildSubCollection","_a","slice","map","collection","id","name","humanBytes","size_bytes","dataset_count","getRows","async","response","ArchAPI","get","count","items","__decorate","state","prototype","customElement"],"mappings":"4aAIA,MAAeA,EAAA,CACbC,EACAC,EACAC,CAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;KCME,IAAMC,EAAmBC,EAAzB,cAAkCC,EAOvCC,cACEC,QAPOC,KAAmBC,oBAAG,EACtBD,KAAWE,iBAAkCC,EAO/CH,KAAKI,iBACX,CAEDC,SACE,MAAMC,wBAAEA,GAA4BV,EAC9BW,OAAiCJ,IAArBH,KAAKE,YAEjBM,EAAiBR,KAAKC,oBAAsB,EA+ClD,OAAOQ,CAAI;;;mBAGIF,GAAaC,EACpB,2BACA;mBACOE,EAAMC;;;;;;;;;yBASAJ,IAAcC,EAAiB,gBAAkB;;;;;;;;gBA7DtD,YACd,OAAAD,EACI,CACEE,CAAI;;;;;;eAQLD,GAiBoB,QAApBI,EAAAZ,KAAKE,mBAAe,IAAAU,EAAAA,EAAA,IAAIC,MAAM,EAAGP,GAAyBQ,KACxDC,GAAeN,CAAI;;;;yCAISM,EAAWC;6BACvBD,EAAWE;;sBAElBF,EAAWE;;;mCAGEC,EAAWH,EAAWI,WAAY;;oBAEjDJ,EAAWK;;;gBA7BrB,CACEX,CAAI;;;;;;;;;;;;;cAgCL,EAwBKY;;;;;YAKJd,IAAcC,EACZC,CAAI,GACJA,CAAI;;;oBAGET,KAAKC,oBAAsBK,EACzBG,CAAI,OAAOT,KAAKC,sBAChBQ,CAAI;;;;;;KAOvB,CAEOa,wBACN,MAAMC,QAAiBC,EAAQtB,YAAYuB,IAAI,CAG7C,CAAC,QAAS,IAAK7B,EAAoBU,2BAErCN,KAAKC,oBAAsBsB,EAASG,MACpC1B,KAAKE,YAAcqB,EAASI,KAC7B,GA/GMhC,EAAuBW,wBAAG,GAC1BX,EAAMJ,OAAGA,EAJPqC,EAAA,CAARC,KAAgClC,EAAAmC,UAAA,2BAAA,GACxBF,EAAA,CAARC,KAA+DlC,EAAAmC,UAAA,mBAAA,GAFrDnC,EAAmBC,EAAAgC,EAAA,CAD/BG,EAAc,0BACFpC"}