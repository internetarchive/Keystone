{"version":3,"file":"collection-surveyor-search-results.js","sources":["../../../web-components/node_modules/@lit/reactive-element/decorators/state.js","../../../web-components/node_modules/@lit/reactive-element/decorators/base.js","../../../../../web-components/src/lib/api/fetch.ts","../../../../../web-components/src/lib/api/search.ts","../../../../../web-components/src/collectionSurveyorSearchResults/src/collection-surveyor-search-results.ts","../../../web-components/node_modules/@lit/reactive-element/decorators/event-options.js"],"sourcesContent":["import{property as r}from\"./property.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function t(t){return r({...t,state:!0})}export{t as state};\n//# sourceMappingURL=state.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst e=(e,t,o)=>{Object.defineProperty(t,o,e)},t=(e,t)=>({kind:\"method\",placement:\"prototype\",key:t.key,descriptor:e}),o=({finisher:e,descriptor:t})=>(o,n)=>{var r;if(void 0===n){const n=null!==(r=o.originalKey)&&void 0!==r?r:o.key,i=null!=t?{kind:\"method\",placement:\"prototype\",key:n,descriptor:t(o.key)}:{...o,key:n};return null!=e&&(i.finisher=function(t){e(t,n)}),i}{const r=o.constructor;void 0!==t&&Object.defineProperty(o,n,t(n)),null==e||e(r,n)}};export{o as decorateProperty,e as legacyPrototypeMethod,t as standardPrototypeMethod};\n//# sourceMappingURL=base.js.map\n","const CSRF_REGEX = /csrftoken=([^;$]+)/;\n\nexport const getCsrfHeader = (): { \"X-CSRFToken\"?: string } => {\n  const csrfMatch = CSRF_REGEX.exec(decodeURIComponent(document.cookie));\n  if (!csrfMatch) {\n    return {};\n  }\n\n  return { \"X-CSRFToken\": csrfMatch[1] };\n};\n\nexport function callJsonApi<Rq, Rsp>(options: {\n  url: string;\n  method: \"GET\" | \"POST\" | \"PUT\" | \"PATCH\" | \"DELETE\";\n  errorMessage: string;\n  body?: Rq;\n}): Promise<Rsp> {\n  const request: RequestInit = {\n    method: options.method,\n    headers: {\n      ...getCsrfHeader(),\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\",\n    },\n  };\n  if (options.body) {\n    request.body = JSON.stringify(options.body);\n  }\n  return (\n    fetch(options.url, request)\n      // cast response to generic response type\n      .then((response) => {\n        if (response.ok) {\n          return response.json().then((r) => r as Rsp);\n        } else {\n          throw new Error(options.errorMessage);\n        }\n      })\n      .catch((error) => {\n        console.error(error);\n        // log error, return no response\n        return Promise.reject(options.errorMessage);\n      })\n  );\n}\n","import { callJsonApi } from \"./fetch\";\nimport { SolrData } from \"../../lib/types\";\n\nfunction getFinalSearchTerm(searchTerm: string, parsedFilters: string[]) {\n  // if search term and no filters, just use search term (which could be an empty string)\n  if (parsedFilters.length === 0) {\n    return searchTerm;\n    // if one filter and no search term, use filter\n  } else if (searchTerm === \"\") {\n    return parsedFilters.join(\" AND \");\n    // if multiple filters and search term, join and use all values\n  } else {\n    return [...parsedFilters, searchTerm].join(\" AND \");\n  }\n}\n\nexport function callSearchApi(\n  searchTerm: string,\n  parsedFilters: string[]\n): Promise<SolrData> {\n  const finalSearchTerm = getFinalSearchTerm(searchTerm, parsedFilters);\n\n  return callJsonApi<undefined, SolrData>({\n    url: `/collection_surveyor/search/?q=${encodeURIComponent(\n      finalSearchTerm\n    )}`,\n    method: \"GET\",\n    errorMessage: \"error in collection surveyor search\",\n  });\n}\n","import { html, css, LitElement, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators.js\";\nimport { eventOptions } from \"lit/decorators/event-options.js\";\n\nimport \"../../collectionSurveyorFacet/index\";\nimport \"../../collectionSurveyorPagination/index\";\nimport \"../../collectionSurveyorCart/index\";\nimport \"../../collectionSurveyorSearchBar/index\";\nimport \"../../collectionSurveyorActiveFilters/index\";\n\nimport {\n  CollectionSearchResult,\n  Facets,\n  CollectionCheckboxEventDetail,\n  CollectionSelectedDetail,\n  SelectedFacets,\n  SolrData,\n  CollectionRemovedFromCartDetail,\n} from \"../../lib/types\";\n\nimport { humanBytes } from \"../../lib/webservices/src/lib/helpers\";\nimport { callSearchApi } from \"../../lib/api/search\";\n\n@customElement(\"collection-surveyor-search-results\")\nexport class CollectionSurveyorSearchResults extends LitElement {\n  @property({ type: Array }) collections?: CollectionSearchResult[] = undefined;\n\n  @property({ type: Object }) facets?: Facets = {};\n\n  @property({ type: Boolean }) isLoading = true;\n\n  @state() collectionsSelected: {\n    [collectionName: string]: CollectionSelectedDetail;\n  } = {};\n\n  @state()\n  selectedFacets: SelectedFacets = {\n    f_collectionName: [],\n    f_organizationName: [],\n    f_organizationType: [],\n  };\n\n  @state() searchTerm = \"\";\n\n  @state() currentPage = 1;\n\n  @property({ type: Number }) itemsPerPage = 10;\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.search();\n  }\n\n  private get collectionsLength() {\n    return this.collections ? this.collections.length : 0;\n  }\n\n  private get startIndex(): number {\n    return (this.currentPage - 1) * this.itemsPerPage;\n  }\n\n  private get endIndex(): number {\n    return this.startIndex + this.itemsPerPage;\n  }\n\n  private get paginatedResults() {\n    return this.collections?.slice(this.startIndex, this.endIndex);\n  }\n\n  // event handler for selecting/deselecting a collection\n  handleUpdateCollectionsSelected(event: CustomEvent) {\n    const {\n      collectionSize,\n      isChecked,\n      collectionName,\n      collectionId,\n    }: CollectionCheckboxEventDetail =\n      event.detail as CollectionCheckboxEventDetail;\n\n    if (isChecked) {\n      const sizeIdMap: CollectionSelectedDetail = {\n        collectionSize: collectionSize,\n        collectionId: collectionId,\n      };\n\n      // create a new collectionsSelected object with the existing selected collections plus the latest selected collection\n      this.collectionsSelected = {\n        ...this.collectionsSelected,\n        [collectionName]: sizeIdMap,\n      };\n    } else {\n      this.removeCollectionFromCollectionsSelected(collectionName);\n    }\n  }\n\n  // event handler for removing collection from cart\n  handleRemoveCollectionFromCart(event: CustomEvent) {\n    const { collectionName }: CollectionRemovedFromCartDetail =\n      event.detail as CollectionRemovedFromCartDetail;\n    this.removeCollectionFromCollectionsSelected(collectionName);\n  }\n\n  removeCollectionFromCollectionsSelected(collectionName: string) {\n    // create new collectionsSelected object excluding the deselected collection\n    const { [collectionName]: _, ...rest } = this.collectionsSelected;\n    this.collectionsSelected = { ...rest };\n  }\n\n  // event handler for pagination\n  handlePageChange(event: CustomEvent) {\n    this.currentPage = Number(event.detail);\n  }\n\n  // event handler for selecting facets\n  handleFacetSelected(event: CustomEvent) {\n    const facetName = (event.detail as { facetName: string }).facetName;\n    const facetFieldName = (\n      event.detail as { facetFieldName: keyof SelectedFacets }\n    ).facetFieldName;\n\n    this.selectedFacets = {\n      ...this.selectedFacets,\n      [facetFieldName]: [...this.selectedFacets[facetFieldName], facetName],\n    };\n\n    this.search();\n  }\n\n  // event handler for deselecting facets\n  handleFacetDeselected(event: CustomEvent) {\n    const facetName = (event.detail as { facetName: string }).facetName;\n    const facetFieldName = (\n      event.detail as { facetFieldName: keyof SelectedFacets }\n    ).facetFieldName;\n\n    // create new selectedFacets object, which is needed to update state and re-render\n    this.selectedFacets = {\n      ...this.selectedFacets,\n      [facetFieldName]: this.selectedFacets[facetFieldName].filter(\n        (value) => value !== facetName\n      ),\n    };\n\n    this.search();\n  }\n\n  private get filterQuery(): string[] {\n    return Object.entries(this.selectedFacets).flatMap(\n      ([facetFieldName, facetValues]: [string, string[]]) => {\n        // remove f_ prefix, eg. f_collectionName => collectionName\n        const searchableFieldName = facetFieldName.slice(2);\n\n        return facetValues.map(\n          (facetValue: string) => `${searchableFieldName}:\"${facetValue}\"`\n        );\n      }\n    );\n  }\n\n  // event handler for search term\n  private handleSearchClicked(event: CustomEvent) {\n    const searchText = (event.detail as { searchText: string }).searchText;\n    this.searchTerm = searchText;\n\n    this.search();\n  }\n\n  private search(): void {\n    this.isLoading = true;\n\n    callSearchApi(this.searchTerm, this.filterQuery)\n      .then((data: SolrData) => {\n        this.collections = data.collections;\n        this.facets = data.facets;\n        this.isLoading = false;\n      })\n      .catch((error) => {\n        this.isLoading = false;\n      });\n  }\n\n  render() {\n    return html`\n      <!-- Collections Cart -->\n      <collection-surveyor-cart\n        .collectionsInCart=${this.collectionsSelected}\n        @collection-removed-from-cart=${this.handleRemoveCollectionFromCart}\n      ></collection-surveyor-cart>\n\n      <!-- Search Bar -->\n      <collection-surveyor-search-bar\n        .searchText=${this.searchTerm}\n        @search-clicked=\"${this.handleSearchClicked}\"\n      ></collection-surveyor-search-bar>\n\n      <!-- Facets and Collections-->\n      <div class=\"facets-and-collections-container\">\n        <!-- Loading icon -->\n          <div class=\"loading\">\n            ${this.isLoading ? html`<div class=\"spinner\"></div>` : html``}\n          </div>\n\n        ${\n          this.collectionsLength !== 0\n            ? html`\n                <!-- Facets  -->\n                <div class=\"facets-container\">\n                  <div>\n                    <h4>Narrow Your Results</h4>\n                    ${this.facets\n                      ? html` ${Object.entries(this.facets).map(\n                          ([key, value]) => html`\n                            <collection-surveyor-facet\n                              .facetField=${key}\n                              .facetFieldResults=${value}\n                              .selectedfacetFieldResults=${this.selectedFacets[\n                                key as keyof SelectedFacets\n                              ]}\n                              @facet-selected=${this.handleFacetSelected}\n                              @facet-deselected=${this.handleFacetDeselected}\n                            ></collection-surveyor-facet>\n                          `\n                        )}`\n                      : html`<p>No facets available</p>`}\n                  </div>\n                </div>\n\n                <!-- Collections -->\n                <div class=\"collections-container\">\n                  <!-- Active Filters -->\n                  <collection-surveyor-active-filters\n                    .activeFilters=${this.selectedFacets}\n                    @facet-deselected=${this.handleFacetDeselected}\n                  ></collection-surveyor-active-filters>\n\n                  <!-- Pagination top of page -->\n                  <collection-surveyor-pagination\n                    .currentPage=\"${this.currentPage}\"\n                    .totalResults=\"${this.collectionsLength}\"\n                    .itemsPerPage=\"${this.itemsPerPage}\"\n                    @page-changed=\"${this.handlePageChange}\"\n                  ></collection-surveyor-pagination>\n\n                  <!-- Collections -->\n                  ${this.paginatedResults?.map(\n                    (collection) => html`\n                      <collection-surveyor-search-result\n                        .collection=${collection}\n                        .isChecked=${collection.collectionName in\n                        this.collectionsSelected}\n                        @update-collections-selected=\"${this\n                          .handleUpdateCollectionsSelected}\"\n                      ></collection-surveyor-search-result>\n                    `\n                  )}\n\n                  <!-- Pagination bottom of page -->\n                  <collection-surveyor-pagination\n                    .currentPage=\"${this.currentPage}\"\n                    .totalResults=\"${this.collectionsLength}\"\n                    .itemsPerPage=\"${this.itemsPerPage}\"\n                    @page-changed=\"${this.handlePageChange}\"\n                  ></collection-surveyor-pagination>\n                </div>\n              `\n            : html``\n        }\n\n        ${\n          this.collectionsLength === 0 && !this.isLoading\n            ? html`\n                <div class=\"no-results-message\">\n                  <h2>No Results Found For Your Search</h2>\n                  <p>Try a new search or clear your previous search</p>\n                  <p></p>\n                </div>\n              `\n            : html``\n        }\n        </div>\n      </div>\n    `;\n  }\n\n  static styles = css`\n    .facets-and-collections-container {\n      display: flex;\n      background-color: rgb(248, 248, 248);\n      position: relative;\n    }\n\n    .facets-container {\n      display: flex;\n      padding: 10px 30px 10px 50px;\n      width: 40%;\n    }\n\n    .collections-container {\n      display: flex;\n      flex-direction: column;\n      padding: 10px;\n      padding-right: 50px;\n      width: -webkit-fill-available;\n    }\n\n    .no-results-message {\n      margin: auto;\n      text-align: center;\n    }\n\n    .loading {\n      height: 100px;\n      padding-left: 50%;\n      position: absolute;\n    }\n\n    .spinner {\n      border: 4px solid rgba(0, 0, 0, 0.1);\n      border-left-color: #333;\n      border-radius: 50%;\n      width: 50px;\n      height: 50px;\n      animation: spin 1s linear infinite;\n    }\n\n    @keyframes spin {\n      to {\n        transform: rotate(360deg);\n      }\n    }\n  `;\n}\n\n@customElement(\"collection-surveyor-search-result\")\nexport class CollectionSurveyorSearchResult extends LitElement {\n  @property({ type: Object }) collection!: CollectionSearchResult;\n\n  @property({ type: Boolean }) isChecked = false;\n\n  @eventOptions({ capture: true })\n  handleCheckboxChange(event: Event) {\n    const checkbox = event.target as HTMLInputElement;\n    const { collectionId, collectionName, collectionSize } = checkbox.dataset;\n\n    const customEvent = new CustomEvent(\"update-collections-selected\", {\n      detail: {\n        collectionSize,\n        isChecked: checkbox.checked,\n        collectionName,\n        collectionId,\n      },\n      bubbles: true,\n      composed: true,\n    });\n\n    this.dispatchEvent(customEvent);\n  }\n\n  render() {\n    return html`\n      <div class=\"result-item\">\n        <div class=\"item-detail\">\n          <div class=\"item-detail-text\">\n            <h3>\n              <a\n                href=\"https://archive-it.org/collections/${this.collection\n                  .collectionId}\"\n                target=\"_blank\"\n                >${this.collection.collectionName}</a\n              >\n            </h3>\n            <ul>\n              <li>\n                <span class=\"item-detail-label\"> Organization ID: </span>\n                ${this.collection.organizationId}\n              </li>\n              <li>\n                <span class=\"item-detail-label\"> Organization: </span>\n                ${this.collection.organizationName}\n              </li>\n              <li>\n                <span class=\"item-detail-label\"> Collection ID: </span>\n                ${this.collection.collectionId}\n              </li>\n\n              ${this.collection.meta_Description\n                ? html` <li>\n                    <span class=\"item-detail-label\"> Description: </span>\n                    ${this.collection.meta_Description[0]}\n                  </li>`\n                : nothing}\n              <li>\n                <span class=\"item-detail-label\"> Collection Size: </span>\n                ${humanBytes(this.collection.totalWarcBytes)}\n              </li>\n              <li>\n                <input\n                  type=\"checkbox\"\n                  data-collection-id=${this.collection.collectionId}\n                  data-collection-name=${this.collection.collectionName}\n                  data-collection-size=${this.collection.totalWarcBytes}\n                  @change=${this.handleCheckboxChange}\n                  .checked=${this.isChecked}\n                />\n                add collection to list\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  static styles = css`\n    .result-item {\n      background-color: rgb(255, 255, 255);\n      border-radius: 6px;\n      box-shadow: rgb(136, 136, 136) 1px 1px 6px;\n      margin-bottom: 15px;\n    }\n\n    .item-detail {\n      padding: 1em;\n      display: flex;\n      flex-direction: row;\n      justify-content: flex-start;\n      align-items: flex-start;\n      gap: 2em;\n    }\n\n    .item-detail-text {\n      max-width: 600px;\n    }\n\n    .item-detail-text h2,\n    .item-detail-text h3 {\n      padding: 0;\n      margin: 0;\n    }\n\n    .item-detail-text ul {\n      list-style-type: none;\n      padding: 0;\n      margin: 0;\n    }\n\n    .item-detail-text ul li {\n      margin: 0.6em 0 0.6em 0;\n    }\n\n    .item-detail-text .item-detail-label {\n      font-weight: bold;\n    }\n  `;\n}\n","import{decorateProperty as r}from\"./base.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function e(e){return r({finisher:(r,t)=>{Object.assign(r.prototype[t],e)}})}export{e as eventOptions};\n//# sourceMappingURL=event-options.js.map\n"],"names":["t","r","state","o","finisher","e","descriptor","n","originalKey","key","i","kind","placement","constructor","Object","defineProperty","CSRF_REGEX","getCsrfHeader","csrfMatch","exec","decodeURIComponent","document","cookie","callSearchApi","searchTerm","parsedFilters","finalSearchTerm","length","join","getFinalSearchTerm","options","request","method","headers","Accept","body","JSON","stringify","fetch","url","then","response","ok","json","Error","errorMessage","catch","error","console","Promise","reject","callJsonApi","encodeURIComponent","CollectionSurveyorSearchResults","LitElement","this","collections","undefined","facets","isLoading","collectionsSelected","selectedFacets","f_collectionName","f_organizationName","f_organizationType","currentPage","itemsPerPage","connectedCallback","super","search","collectionsLength","startIndex","endIndex","paginatedResults","_a","slice","handleUpdateCollectionsSelected","event","collectionSize","isChecked","collectionName","collectionId","detail","sizeIdMap","removeCollectionFromCollectionsSelected","handleRemoveCollectionFromCart","_","rest","handlePageChange","Number","handleFacetSelected","facetName","facetFieldName","handleFacetDeselected","filter","value","filterQuery","entries","flatMap","facetValues","searchableFieldName","map","facetValue","handleSearchClicked","searchText","data","render","html","collection","styles","css","__decorate","property","type","Array","prototype","Boolean","customElement","CollectionSurveyorSearchResult","handleCheckboxChange","checkbox","target","dataset","customEvent","CustomEvent","checked","bubbles","composed","dispatchEvent","organizationId","organizationName","meta_Description","nothing","humanBytes","totalWarcBytes","assign","eventOptions","capture"],"mappings":"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"}