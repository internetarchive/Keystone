{"version":3,"file":"collection-surveyor-search-results.js","sources":["../../../web-components/node_modules/@lit/reactive-element/decorators/state.js","../../../web-components/node_modules/@lit/reactive-element/decorators/base.js","../../../../../web-components/src/collectionSurveyorSearchResults/src/collection-surveyor-search-results.ts","../../../web-components/node_modules/@lit/reactive-element/decorators/event-options.js"],"sourcesContent":["import{property as r}from\"./property.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function t(t){return r({...t,state:!0})}export{t as state};\n//# sourceMappingURL=state.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst e=(e,t,o)=>{Object.defineProperty(t,o,e)},t=(e,t)=>({kind:\"method\",placement:\"prototype\",key:t.key,descriptor:e}),o=({finisher:e,descriptor:t})=>(o,n)=>{var r;if(void 0===n){const n=null!==(r=o.originalKey)&&void 0!==r?r:o.key,i=null!=t?{kind:\"method\",placement:\"prototype\",key:n,descriptor:t(o.key)}:{...o,key:n};return null!=e&&(i.finisher=function(t){e(t,n)}),i}{const r=o.constructor;void 0!==t&&Object.defineProperty(o,n,t(n)),null==e||e(r,n)}};export{o as decorateProperty,e as legacyPrototypeMethod,t as standardPrototypeMethod};\n//# sourceMappingURL=base.js.map\n","import { html, css, LitElement, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators.js\";\nimport { eventOptions } from \"lit/decorators/event-options.js\";\n\nimport \"../../collectionSurveyorFacet/index\";\nimport \"../../collectionSurveyorPagination/index\";\nimport \"../../collectionSurveyorCart/index\";\n\nimport {\n  CollectionSearchResult,\n  Facets,\n  CollectionCheckboxEventDetail,\n  CollectionSelectedDetail,\n} from \"../../lib/types\";\n\nimport { humanBytes } from \"../../lib/webservices/src/lib/helpers\";\n\n@customElement(\"collection-surveyor-search-results\")\nexport class CollectionSurveyorSearchResults extends LitElement {\n  @property({ type: Array }) collections?: CollectionSearchResult[] = undefined;\n\n  @property({ type: Object }) facets?: Facets = {};\n\n  @state() collectionsSelected: {\n    [collectionName: string]: CollectionSelectedDetail;\n  } = {};\n\n  @state() currentPage = 1;\n\n  @property({ type: Number }) itemsPerPage = 10;\n\n  private get collectionsLength() {\n    return this.collections ? this.collections.length : 0;\n  }\n\n  private get startIndex(): number {\n    return (this.currentPage - 1) * this.itemsPerPage;\n  }\n\n  private get endIndex(): number {\n    return this.startIndex + this.itemsPerPage;\n  }\n\n  private get paginatedResults() {\n    return this.collections?.slice(this.startIndex, this.endIndex);\n  }\n\n  // event handler for selecting/deselecting a collection\n  handleUpdateCollectionsSelected(event: CustomEvent) {\n    const {\n      collectionSize,\n      isChecked,\n      collectionName,\n      collectionId,\n    }: CollectionCheckboxEventDetail =\n      event.detail as CollectionCheckboxEventDetail;\n\n    if (isChecked) {\n      const sizeIdMap: CollectionSelectedDetail = {\n        collectionSize: collectionSize,\n        collectionId: collectionId,\n      };\n\n      // create a new collectionsSelected object with the existing selected collections plus the latest selected collection\n      this.collectionsSelected = {\n        ...this.collectionsSelected,\n        [collectionName]: sizeIdMap,\n      };\n    } else {\n      // create new collectionsSelected object excluding the deselected collection\n      const { [collectionName]: _, ...rest } = this.collectionsSelected;\n      this.collectionsSelected = { ...rest };\n    }\n  }\n\n  // event handler for pagination\n  handlePageChange(event: CustomEvent) {\n    this.currentPage = Number(event.detail);\n  }\n\n  render() {\n    return html`\n      <!-- Collections Cart -->\n      <collection-surveyor-cart\n        .collectionsInCart=${this.collectionsSelected}\n      ></collection-surveyor-cart>\n\n      <!-- Facets and Collections-->\n      <div class=\"facets-and-collections-container\">\n        <!-- Facets  -->\n        <div class=\"facets-container\">\n          <div>\n            <h4>Narrow Your Results</h4>\n            ${this.facets\n              ? html` ${Object.entries(this.facets).map(\n                  ([key, value]) => html`\n                    <collection-surveyor-facet\n                      .facetField=${key}\n                      .facetFieldResults=${value}\n                    ></collection-surveyor-facet>\n                  `\n                )}`\n              : html`<p>No facets available</p>`}\n          </div>\n        </div>\n\n        <!-- Collections -->\n        <div class=\"collections-container\">\n          <!-- Pagination top of page -->\n          <collection-surveyor-pagination\n            .currentPage=\"${this.currentPage}\"\n            .totalResults=\"${this.collectionsLength}\"\n            .itemsPerPage=\"${this.itemsPerPage}\"\n            @page-changed=\"${this.handlePageChange}\"\n          ></collection-surveyor-pagination>\n\n          <!-- Collections -->\n          ${this.paginatedResults?.map(\n            (collection) => html`\n              <collection-surveyor-search-result\n                .collection=${collection}\n                .isChecked=${collection.collectionName in\n                this.collectionsSelected}\n                @update-collections-selected=\"${this\n                  .handleUpdateCollectionsSelected}\"\n              ></collection-surveyor-search-result>\n            `\n          )}\n\n          <!-- Pagination bottom of page -->\n          <collection-surveyor-pagination\n            .currentPage=\"${this.currentPage}\"\n            .totalResults=\"${this.collectionsLength}\"\n            .itemsPerPage=\"${this.itemsPerPage}\"\n            @page-changed=\"${this.handlePageChange}\"\n          ></collection-surveyor-pagination>\n        </div>\n      </div>\n    `;\n  }\n\n  static styles = css`\n    .facets-and-collections-container {\n      display: flex;\n      background-color: rgb(248, 248, 248);\n    }\n\n    .facets-container {\n      display: flex;\n      padding: 10px;\n      padding-left: 50px;\n      max-width: 400px;\n    }\n\n    .collections-container {\n      display: flex;\n      flex-direction: column;\n      padding: 10px;\n      padding-right: 50px;\n      width: -webkit-fill-available;\n    }\n  `;\n}\n\n@customElement(\"collection-surveyor-search-result\")\nexport class CollectionSurveyorSearchResult extends LitElement {\n  @property({ type: Object }) collection!: CollectionSearchResult;\n\n  @property({ type: Boolean }) isChecked = false;\n\n  @eventOptions({ capture: true })\n  handleCheckboxChange(event: Event) {\n    const checkbox = event.target as HTMLInputElement;\n    const { collectionId, collectionName, collectionSize } = checkbox.dataset;\n\n    const customEvent = new CustomEvent(\"update-collections-selected\", {\n      detail: {\n        collectionSize,\n        isChecked: checkbox.checked,\n        collectionName,\n        collectionId,\n      },\n      bubbles: true,\n      composed: true,\n    });\n\n    this.dispatchEvent(customEvent);\n  }\n\n  render() {\n    return html`\n      <div class=\"result-item\">\n        <div class=\"item-detail\">\n          <div class=\"item-detail-text\">\n            <h3>\n              <a\n                href=\"https://archive-it.org/collections/${this.collection\n                  .collectionId}\"\n                target=\"_blank\"\n                >${this.collection.collectionName}</a\n              >\n            </h3>\n            <ul>\n              <li>\n                <span class=\"item-detail-label\"> Organization ID: </span>\n                ${this.collection.organizationId}\n              </li>\n              <li>\n                <span class=\"item-detail-label\"> Organization: </span>\n                ${this.collection.organizationName}\n              </li>\n              <li>\n                <span class=\"item-detail-label\"> Collection ID: </span>\n                ${this.collection.collectionId}\n              </li>\n\n              ${this.collection.meta_Description\n                ? html` <li>\n                    <span class=\"item-detail-label\"> Description: </span>\n                    ${this.collection.meta_Description[0]}\n                  </li>`\n                : nothing}\n              <li>\n                <span class=\"item-detail-label\"> Collection Size: </span>\n                ${humanBytes(this.collection.totalWarcBytes)}\n              </li>\n              <li>\n                <input\n                  type=\"checkbox\"\n                  data-collection-id=${this.collection.collectionId}\n                  data-collection-name=${this.collection.collectionName}\n                  data-collection-size=${this.collection.totalWarcBytes}\n                  @change=${this.handleCheckboxChange}\n                  .checked=${this.isChecked}\n                />\n                add collection to list\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  static styles = css`\n    .result-item {\n      background-color: rgb(255, 255, 255);\n      border-radius: 6px;\n      box-shadow: rgb(136, 136, 136) 1px 1px 6px;\n      margin-bottom: 15px;\n    }\n\n    .item-detail {\n      padding: 1em;\n      display: flex;\n      flex-direction: row;\n      justify-content: flex-start;\n      align-items: flex-start;\n      gap: 2em;\n    }\n\n    .item-detail-text {\n      max-width: 600px;\n    }\n\n    .item-detail-text h2,\n    .item-detail-text h3 {\n      padding: 0;\n      margin: 0;\n    }\n\n    .item-detail-text ul {\n      list-style-type: none;\n      padding: 0;\n      margin: 0;\n    }\n\n    .item-detail-text ul li {\n      margin: 0.6em 0 0.6em 0;\n    }\n\n    .item-detail-text .item-detail-label {\n      font-weight: bold;\n    }\n  `;\n}\n","import{decorateProperty as r}from\"./base.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function e(e){return r({finisher:(r,t)=>{Object.assign(r.prototype[t],e)}})}export{e as eventOptions};\n//# sourceMappingURL=event-options.js.map\n"],"names":["t","r","state","o","finisher","e","descriptor","n","originalKey","key","i","kind","placement","constructor","Object","defineProperty","CollectionSurveyorSearchResults","LitElement","this","collections","undefined","facets","collectionsSelected","currentPage","itemsPerPage","collectionsLength","length","startIndex","endIndex","paginatedResults","_a","slice","handleUpdateCollectionsSelected","event","collectionSize","isChecked","collectionName","collectionId","detail","sizeIdMap","_","rest","handlePageChange","Number","render","html","entries","map","value","collection","styles","css","__decorate","property","type","Array","prototype","customElement","CollectionSurveyorSearchResult","handleCheckboxChange","checkbox","target","dataset","customEvent","CustomEvent","checked","bubbles","composed","dispatchEvent","organizationId","organizationName","meta_Description","nothing","humanBytes","totalWarcBytes","Boolean","assign","eventOptions","capture"],"mappings":"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"}